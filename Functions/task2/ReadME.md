### Само задание
Имеется код, анализ которого надо произвести с помощью отладчика для выяснения длины массива для ввода пароля и адреса ветки условия проверки корректности ввода пароля, которая выполняется при условии совпадения паролей. Ввести пароль таким образом, чтобы перезаписать адрес возврата на выясненный адрес.

Код находится в файле task2.c

![[Pasted image 20250109110450.png]]
Компилируем файл с флагами, чтобы отключить защиту от переполнения стека и выхода за его границы

![[Pasted image 20250109110655.png]]
Запускаем скомпилированный выходной файл с помощью GDB и сразу делаем метку для остановки на функции main (команда "b main"), чтобы можно было ее проанализировать, начинаем выполнять код нашей программы (команда "r").

![[Pasted image 20250109110905.png]]
В функции main останавливаемся на том моменте, когда нас просят ввести пароль и пишем команду (disassemble),  чтобы посмотреть где в памяти хранятся те или иные команды, чтобы понять, какой новый адрес нам нужно будет записать при переполнении стека.
В нашем случае необходима строка, которая выводит что успешно получили доступ, это строка "0x00...4011d8"

![[Pasted image 20250109112155.png]]
Далее доходим до кода функции IsPassOk и смотрим что находится внутри стека до того, как мы начали заполнять какие-либо данные и после. Можно увидеть, что массив, хранящий пароль хранится на адресах 0x7fffffffdce4-0x7fffffffdce9. После него хранится 8 байт адреса rbp, и далее 8 байта адреса возврата, которые и необходимо переписать на ту ветку, которая необходима по заданию.

По итогу, при запуске файла нам нужно передать строку, которая состоит из: 12 любых символов, адреса rbp, который должен остаться таким же, 8 байт нового адреса возврата.
Для того чтобы адрес корректно записался, необходимо записать его в бинарный файл, и перенаправить в исполняемый код.

Скрип, для создания и заполнения бинарника находится в файле output.sh:
 ![[Pasted image 20250109113234.png]]

В итоге мы получаем необходимый нам результат, и можем радоваться жизни:

![[Pasted image 20250109113351.png]]